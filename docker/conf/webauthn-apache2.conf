<Virtualhost *:80>
    ServerName  webauthn
    ServerAdmin admin@surf.nl

    DocumentRoot /var/www/html/public

    SetEnv APP_ENV prod
    SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1

    <Directory "/var/www/html/public">
        Require all granted

        Options -MultiViews
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^(.*)$ index.php [QSA,L]
    </Directory>

    Header always set X-Content-Type-Options "nosniff"

    # Proxy the requests to FPM
    <FilesMatch \.php$>
        SetHandler "proxy:unix:/usr/local/var/run/webauthn-pool-72.sock|fcgi://127.0.0.1:9000/"
    </FilesMatch>

    ExpiresActive on
    ExpiresByType font/* "access plus 1 year"
    ExpiresByType image/* "access plus 6 months"
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType text/js "access plus 1 year"
</VirtualHost>
